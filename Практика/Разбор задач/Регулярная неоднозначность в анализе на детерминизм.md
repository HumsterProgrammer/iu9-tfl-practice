Пусть описание языка дано в свёрточной форме, описываемой как множество возможных конкатенаций составных частей слов. При этом на некоторые составные части могут быть даны регулярные ограничения. 
Если стоит задача проанализировать язык $\mathcal{L}$ на детерминированность, то имеет смысл сначала понять, какие переходы между составными частями не получится отследить с помощью только состояний стекового автомата. Потому что недетерминизм в контекстно-свободных языках связан конкретно с недетерминизмом при работе со стеком, а если некоторые переходы можно увидеть и без заглядывания в стек, они точно могут быть обработаны детерминированно.

А именно, мы хотим представить слова из языка в рамках каркаса однозначного регулярного выражения (то есть не допускающего больше чем одно дерево разбора). В идеальном случае, каркасное регулярное выражение будет ещё и 1-однозначным - то есть выбор между альтернативами в нём или между возможностью зайти в итерацию и не заходить в неё будет определяться следующей прочитанной буквой. 

> [!example] Пример
> Выражение $(a|b)^* a (a|b)$ однозначно, но не 1-однозначно, поскольку при чтении очередной буквы $a$ с ленты нет возможности понять, следует ли остаться внутри итерации или выйти за неё. 
> Выражение $a^*\bigl(bba(bba)^*aa^*b^*\bigr)?$ 1-однозначно, поскольку все решения о продолжениях нахождения внутри итераций или заходах в опцию можно сделать, глядя на следующий символ ленты: $a$, $b$, либо конец строки $\$$.

1-однозначное выражение может быть экспоненциально длиннее, чем просто однозначное (и не всегда существует), поэтому, хотя мы и стремимся сделать переходы в альтернативах детерминированными, не всегда будет достигаться чистая 1-однозначность. В частности, выражение $(aa|bb)^*ab$, очевидно, однозначно, но понять, продолжать ли находиться внутри итерации или нет, можно, заглянув вперёд не на один, а на два символа.  В принципе, мы могли бы переписать его в 1-однозначную форму $a(a(bb)^*a)^*b$, но она чуть хуже отражает смысл описываемого языка, чем исходное выражение.

> [!tip] Ограничения метода
> Мы подразумеваем, что ограничения на поведение стека описаны единообразно, то есть стек ведёт себя одинаково на одних и тех же частях слов, варьирует только их представление и переходы между ними. В противном случае, анализ на неоднозначности регулярной структуры даст слишком мало информации о детерминированности языка, например, как в случае ограниченного языка $\bigl\{a^{k_1} b^{k_2} c^{k_3} d^{k_4}\mid k_1=k_3 \vee k_2=k_4\bigr\}$. Язык недетерминированный (более того, существенно неоднозначный), но все переходы между составными частями слов языка однозначны с точки зрения его регулярной структуры.

Например, рассмотрим следующий язык:
$$\mathcal{L}_0=\bigl\{\omega a^n b^n \omega^R\mid \omega\in (abb)^*\,\&\, n>0\bigr\}$$
Выпишем регулярку, в которую вкладывается язык $\mathcal{L}_0$ , заменив все степени на произвольные итерации: $\textcolor{blue}{(abb}\underbrace{\textcolor{blue}{{})^*\;a^+}}_{\text{переход }1} \overbrace{\textcolor{red}{b^+\;(}}^{\text{переход }2}\textcolor{red}{bba)^*}$. Синим цветом выделены регулярные части, в которых в стек закладывается информация, красным - в которых она снимается.
В каких случаях эта регулярка будет неоднозначной?
Если $a^+$ раскрывается больше чем в одну букву $a$, то можно сразу же сделать вывод о том, что часть $(abb)^*$ уже пройдена. То есть при чтении инфикса $a^2$ ситуация с переходом 1 однозначна. В этом случае, учитывая, что $n$ есть минимум 2, выражение и поведение стека в нём можно переписать следующим образом:
$$\underbrace{\textcolor{gray}{a}\bigl(\textcolor{gray}{bba}\textcolor{blue}{(bba)^*}}_{\omega a}\overbrace{\textcolor{gray}{a} \textcolor{blue}{a^*}}^{a^{n-1}} \underbrace{\overbrace{\textcolor{gray}{b^4} \textcolor{red}{b^*}}^{b^{n}bb,\text{ если }\omega\neq\varepsilon}(\textcolor{gray}{a}\textcolor{red}{(bba)^*})}_{b^{n} \omega^R,\text{ если }\omega\neq\varepsilon}|\overbrace{\textcolor{blue}{a^+}\textcolor{gray}{b}\textcolor{red}{b^+}}^{a^{n-1}b^n,\text{ если }\omega=\varepsilon}\bigr)$$
Регулярное выражение, на которое накладываются стековые ограничения, однозначно, что гарантирует детерминизм соответствующего PDA. Здесь мы добавляем выделение серым, в том случае, если чтение буквы никак не влияет на стек, а меняет только состояние. 

Пусть теперь $a^+$ раскрывается ровно в одну букву $a$. Тогда мы точно знаем значение $n$ (это единица) и получаем следующее выражение:
$$\overbrace{\underbrace{\textcolor{gray}{ab}}_{a^n b^n\text{, если }\omega=\varepsilon} (\textcolor{gray}{babb}\textcolor{blue}{(abb)^*}}^{\omega a^n b^n b}\underbrace{\textcolor{gray}{ba}}_{\text{конец }bba \text{ из }\omega^R}\overbrace{\textcolor{red}{(bba)^*}}^{\omega^R\text{ без }1\text{ итерации}})?$$
Опять получившееся регулярное выражение однозначно. Причём видно, что его можно детерминированно объединить с выражением выше:
$$\overbrace{\textcolor{gray}{a}\biggl(\textcolor{gray}{b}}^{a^1 b^1, \;\omega=\varepsilon}\biggl(\textcolor{gray}{ba}\bigl(\textcolor{gray}{bb}\textcolor{blue}{(abb)^*}\bigl(\underbrace{\textcolor{gray}{ba}\textcolor{red}{(bba)^*}}_{\text{случай }n=1,\;\omega\neq\varepsilon}| \overbrace{\textcolor{gray}{a}\textcolor{blue}{a^*} \textcolor{gray}{b^4} \textcolor{red}{b^*} \textcolor{gray}{abba}\textcolor{red}{(bba)^*}}^{\text{случай }n\geq 2,\;\omega=(abb)^{2+}}\bigr)|\underbrace{\textcolor{gray}{a}\textcolor{blue}{a^*} \textcolor{gray}{b^4}\textcolor{red}{b^*}\textcolor{gray}{a}}_{\text{случай }n\geq2,\;\omega=abb}\bigr)\biggr)?\,|\overbrace{\textcolor{blue}{a^+}\textcolor{gray}{b}\textcolor{red}{b^+}}^{\text{случай }n\geq 2,\;\omega=\varepsilon}\biggr)$$
Таким образом, все переходы между разными вариациями поведения стека можно отследить в рамках указанного регулярного выражения, и язык детерминированный.

В данном случае мы могли обойтись введением конечного числа промежуточных состояний (соответствующих буквам, раскрашенным серым), потому что переход между наполнением стека (синими буквами) и чтением из стека (красными буквами) легко определяется по тому, сколько подряд букв $b$ или букв $a$ прочиталось в очередной итерации. Посмотрим, что происходит, если регулярное выражение содержит неоднозначный переход между частями слова с разным поведением стека.

Теперь язык для исследования выглядит так:
$$\mathcal{L}_1 = \bigl\{\omega\,ab\,\omega^R\mid \omega\in (a(bb)^+)^+\bigr\}$$
Построим регулярный каркас $\mathcal{L}_1$ и раскрасим его части в зависимости от поведения стека: $\textcolor{blue}{(a(bb)^+)^+}\textcolor{gray}{ab} \textcolor{red}{((bb)^+a)^+}$. Формально, переход от серой части к красной детерминирован: действительно, если раскрыть обязательную итерацию, получим: 
$$\textcolor{blue}{a(bb)^+(a(bb)^+)^*}\textcolor{gray}{a}\underbrace{\textcolor{gray}{b} \textcolor{red}{(bb)^+}}_{\text{смена поведения стека}} \textcolor{red}{a ((bb)^+a)^*}$$Везде в синей области число букв $b$ между каждыми соседними $a$ чётно, а при переходе из серой в красную оно нечётно. Однако понять, что парсер уже в красной области, можно лишь считав *последнюю букву* из не ограниченной по длине серии $\textcolor{gray}{b}\textcolor{red}{(bb)^+}$. Поэтому невозможно предсказать, что делать с очередной последовательностью из букв $b$, пока все встреченные до неё содержали чётное число букв: то ли класть в стек, то ли уже снимать.
Основываясь на этом наблюдении, легко построить два слова с равными префиксами, в которых действия на этих префиксах различны, предполагая $n$ длиной накачки, т.е. верхней оценкой на число состояний детерминированного PDA:
$$
\begin{cases}\omega_1=\overbrace{\textcolor{blue}{ab^{2n}} \textcolor{gray}{a b}\textcolor{red}{b^{n-1}}}^{x}\overbrace{\textcolor{red}{b^n}}^{y}\overbrace{\textcolor{red}{ba}}^{z_1}= ab^{2n}\,ab\,b^{2n} a\\
\omega_2=\underbrace{\textcolor{blue}{ab^{2n}abb^{n-1}}}_x\underbrace{\textcolor{blue}{b^n}}_{y}\underbrace{\;\,\textcolor{blue}{b^2}\textcolor{gray}{ab}\textcolor{red}{b^{2n+2}a b^{2n} a}}_{z_2} = ab^{2n} ab^{2n+2}\,ab\,b^{2n+2} a b^{2n} a
\end{cases}
$$
Область $xy$ в двух словах синхронно накачивать невозможно, из-за того что нечётный блок $b$ в $\omega_2$ находится в части $z_2$. В то же время, не получится синхронно накачать и $yz_i$, из-за того что в $\omega _1$ часть $y z_1$ находится уже не раньше нечётного блока $b$. Тем самым, язык $\mathcal{L}_1$ не детерминирован.

Ситуация с неопределённостью поведения стека была бы не столь критичной, если бы неоднозначность была в неограниченном подслове, которое не могло бы включать в себя "красные" и "синие" буквы, но могло включать в себя цветные и "серые". Например, в следующем языке:
$$\mathcal{L}_2 = \bigl\{{\omega}\,c^+b^+\omega^R\mid \omega\in (a(bb)^+)^+\bigr\}$$
Строим регулярный каркас: $\textcolor{blue}{a(bb)^+(a(bb)^+)^*} \textcolor{gray}{c^+ b^+}\textcolor{red}{(bb)^+ a ((bb)^+ a)^*}$. Здесь переход между синей и серой частью 1-однозначен: это первая встреченная буква $c$. Но есть неоднозначный переход $\textcolor{gray}{b^+}\textcolor{red}{(bb)^+}$. Без вреда для смысла мы можем переписать его как $\textcolor{red}{(bb)^+}\textcolor{gray}{b^+}$, и обеспечить себе детерминизм разбора, пользуясь структурой стека: пока на стеке лежат буквы $b$, сбрасывать их, а когда там будет буква $a$, то считывать оставшийся фрагмент из букв $b$ регулярно (без изменения состояния стека).

Напомним, что в языках $\mathcal{L}_0$, $\mathcal{L}_1$, $\mathcal{L}_2$ стек заполнялся на синем фрагменте равномерно, и равномерно же опустошался на красном фрагменте. Если такого единообразия не будет (например, как в языке $\bigl\{a^n (b^n \vert b^{2n})\mid n\in \mathbb{N}\bigr\}$), проверки, что в регулярном каркасе нет неоднозначности, не разрешаемой на переходе между синим и красным фрагментами, будет недостаточно для утверждения о том, что язык детерминированный.